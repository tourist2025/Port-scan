import subprocess
import re
import platform

def get_ip_addresses():
    # Decide command based on OS
    if platform.system().lower() == "windows":
        cmd = ["ipconfig"]
    else:  # Linux / macOS
        cmd = ["ifconfig"]

    # Run the command and capture output
    result = subprocess.run(cmd, capture_output=True, text=True)
    output = result.stdout

    # Regex for IPv4 addresses
    ip_pattern = r"(?:\d{1,3}\.){3}\d{1,3}"

    # Find all matches
    ips = re.findall(ip_pattern, output)

    # Filter out invalid ones (like 255.255.255.255, 0.0.0.0, 127.0.0.1 if you want)
    filtered = [ip for ip in ips if not ip.startswith("127.") and not ip.startswith("255.") and ip != "0.0.0.0"]

    return filtered

# Run
print("Detected IPs:", get_ip_addresses())